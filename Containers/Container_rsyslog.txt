Question: Create a container with the name, "logserver" from rhel8/rsyslog image from registry.lab.example.com registry.
          - Configure the container with systemd services as the mshekhawat user using the service name, "container-logserver" 
                    so that it can be persistent across reboot.
          - Configure your host journal to store all journal across reboot copy all journal form /var/log/journal and all subdirectories to 
                    /home/mshekhawat/container-logserver.
          - Create and mount /home/mshekhawat/container-logserver as a persistent storage to the container as /var/log/journal when container start
          - Use "administrator" as the username and "admin123" as the credentials for the image registry. 
          - Use mshekhawat as mshekhawat's password. No root password is needed because wallah is a sudo user.


-- Original Question -- 
Download root less container image rsyslog for user adam. Mount volume: /home/mshekhawat/log to /var/log in container. Also make use that container comes
          up automatically when system is rebooted.
          
  
Solution:

yum module install container-tools

podman login registry.redhat.io

podman pull registry.redhat.io/rhel8/rsyslog

# Verify that image is downloaded
podman images

# Inspect to see its usage
podman inspect registry.redhat.io/rhel8/rsyslog

# make directory
mkdir -p /home/mshekhawat/log

# run conatiner
podman run -d --privileged --name rsyslog --net=host --pid=host -v /home/mshekhawat/log:/var/log:Z --restart=always registry.redhat.io/rhel8/rsyslog:latest /bin/rsyslog.sh

# Verify it is running
podman ps

# Check the linger state
loginctl show-user mshekhawat

# Enable linger for user
loginctl enable-linger mshekhawat

# Verify Linger=yes for mshekhawat
loginctl show-user mshekhawat

# Create user systemd directory
mkdir -p .config/systemd/user

cd .config/systemd/user

# Generate service file
podman generate systemd --name rsyslog --files

# enable user container service
systemctl --user enable container-rsyslog.service

# reload daemon
systemctl --user daemon-reload

# reboot to verify that container is still up after rebooting
reboot

podman ps


# If it is not started then check Restart under [Service] if it is set to on-failure
systemctl --user cat container-rsyslog.service

# Overwrite Restart to always and RestartSec to 1 in nano editor
systemctl --user edit container-rsyslog.service
          [Service]
          Restart=always
          RestartSec=1
          
# reload daemon
systemctl --user daemon-reload

# reboot to verify that container is indeed up after rebooting
reboot

podman ps
